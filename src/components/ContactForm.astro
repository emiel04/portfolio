---
import Button from "./Button.astro";
---

<div class="w-full max-w-2xl mx-auto">
    <div class="text-center mb-12">
        <h2 class="special-font text-2xl font-bold sm:text-5xl mb-3 fade-up-0">
            <span class="blue-gradient">Get in</span> Touch
        </h2>
        <p class="text-gray-400 fade-up-2">Have a question or want to work together?</p>
    </div>

    <form id="contact-form" class="space-y-6">
        <input type="hidden" name="access_key" value="6a025050-4e00-468b-b3b8-4afe13db92ff">
        <input type="checkbox" name="botcheck" class="hidden" style="display: none;">
        
        <div class="grid grid-cols-1 gap-6 md:grid-cols-2 fade-up-4">
            <div>
                <label for="name" class="block text-sm font-medium text-gray-400 mb-2">Name</label>
                <input
                    type="text"
                    id="name"
                    name="name"
                    required
                    class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors text-white placeholder-gray-500"
                    placeholder="Your name"
                />
            </div>
            <div>
                <label for="email" class="block text-sm font-medium text-gray-400 mb-2">Email</label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors text-white placeholder-gray-500"
                    placeholder="your@email.com"
                />
            </div>
        </div>
        <div class="fade-up-6">
            <label for="message" class="block text-sm font-medium text-gray-400 mb-2">Message</label>
            <textarea
                id="message"
                name="message"
                rows="5"
                required
                class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors text-white placeholder-gray-500 resize-none"
                placeholder="Your message here..."
            ></textarea>
        </div>
        <div class="flex flex-col items-center gap-4 fade-up-8">
            <Button type="submit">Send Message</Button>
            <div id="result" class="text-sm min-h-[20px]"></div>
        </div>
    </form>
</div>

<script>
const form = document.getElementById('contact-form') as HTMLFormElement;
const result = document.getElementById('result')!;

form.addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(form);
    const object = Object.fromEntries(formData);
    const json = JSON.stringify(object);
    result.innerHTML = "Please wait...";
    result.className = "text-sm min-h-[20px] text-blue-400";

    fetch('https://api.web3forms.com/submit', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        body: json
    })
    .then(async (response) => {
        let json = await response.json();
        if (response.status == 200) {
            result.innerHTML = "Message sent successfully!";
            result.className = "text-sm min-h-[20px] blue-gradient";
        } else {
            console.log(response);
            result.innerHTML = json.message;
            result.className = "text-sm min-h-[20px] text-red-400";
        }
    })
    .catch(error => {
        console.log(error);
        result.innerHTML = "Something went wrong!";
        result.className = "text-sm min-h-[20px] text-red-400";
    })
    .then(function() {
        form.reset();
        setTimeout(() => {
            result.innerHTML = "";
        }, 3000);
    });
});
</script> 